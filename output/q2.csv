0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> --the query q2
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team12_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10>  
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS q2_results;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10>  
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE q2_results(rooms INT, area_bin DECIMAL(10, 2), mean_price DECIMAL(10, 3), properties INT)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ','
. . . . . . . . . . . . . . . . . . . . . . .> location 'user/team12/project/hive/warehouse/q2'; 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team12_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.resultset.use.unique.column.names = false;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10>  
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO q2_results
. . . . . . . . . . . . . . . . . . . . . . .> SELECT
. . . . . . . . . . . . . . . . . . . . . . .>     rooms,
. . . . . . . . . . . . . . . . . . . . . . .>     FLOOR(area/10)*10 AS area_bin,
. . . . . . . . . . . . . . . . . . . . . . .>     AVG(price) AS mean_price,
. . . . . . . . . . . . . . . . . . . . . . .>     COUNT(*) AS properties
. . . . . . . . . . . . . . . . . . . . . . .> FROM real_estate
. . . . . . . . . . . . . . . . . . . . . . .> WHERE rooms BETWEEN 1 AND 5 
. . . . . . . . . . . . . . . . . . . . . . .>   AND area BETWEEN 20 AND 200
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY rooms, FLOOR(area/10)*10
. . . . . . . . . . . . . . . . . . . . . . .> ORDER BY rooms, area_bin;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM q2_results;
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
| 1      | 20.00     | 2063207.557  | 144297      |
| 1      | 30.00     | 2842330.858  | 1113794     |
| 1      | 40.00     | 3233478.171  | 669340      |
| 1      | 50.00     | 4163208.881  | 93043       |
| 1      | 60.00     | 6362252.036  | 13757       |
| 1      | 70.00     | 8603380.634  | 3466        |
| 1      | 80.00     | 8539959.591  | 2080        |
| 1      | 90.00     | NULL         | 797         |
| 1      | 100.00    | NULL         | 597         |
| 1      | 110.00    | NULL         | 319         |
| 1      | 120.00    | NULL         | 222         |
| 1      | 130.00    | NULL         | 115         |
| 1      | 140.00    | NULL         | 73          |
| 1      | 150.00    | NULL         | 51          |
| 1      | 160.00    | NULL         | 29          |
| 1      | 170.00    | NULL         | 28          |
| 1      | 180.00    | NULL         | 28          |
| 1      | 190.00    | NULL         | 15          |
| 1      | 200.00    | 4970000.000  | 20          |
| 2      | 20.00     | 1548182.022  | 3862        |
| 2      | 30.00     | 3031501.653  | 59043       |
| 2      | 40.00     | 2998311.187  | 574202      |
| 2      | 50.00     | 4350313.485  | 621368      |
| 2      | 60.00     | 5418085.065  | 387380      |
| 2      | 70.00     | 6926193.337  | 119667      |
| 2      | 80.00     | 8673438.891  | 36692       |
| 2      | 90.00     | NULL         | 12241       |
| 2      | 100.00    | NULL         | 4627        |
| 2      | 110.00    | NULL         | 1971        |
| 2      | 120.00    | NULL         | 1319        |
| 2      | 130.00    | NULL         | 507         |
| 2      | 140.00    | NULL         | 341         |
| 2      | 150.00    | NULL         | 225         |
| 2      | 160.00    | NULL         | 141         |
| 2      | 170.00    | NULL         | 89          |
+--------+-----------+--------------+-------------+
| rooms  | area_bin  |  mean_price  | properties  |
+--------+-----------+--------------+-------------+
| 2      | 180.00    | NULL         | 53          |
| 2      | 190.00    | NULL         | 44          |
| 2      | 200.00    | NULL         | 26          |
| 3      | 20.00     | 2012878.372  | 231         |
| 3      | 30.00     | 2288234.551  | 1702        |
| 3      | 40.00     | 2526572.144  | 15927       |
| 3      | 50.00     | 3440403.964  | 169237      |
| 3      | 60.00     | 4037204.786  | 297432      |
| 3      | 70.00     | 6195542.772  | 206525      |
| 3      | 80.00     | 3892707.391  | 207941      |
| 3      | 90.00     | 8816452.606  | 85179       |
| 3      | 100.00    | NULL         | 48331       |
| 3      | 110.00    | NULL         | 23997       |
| 3      | 120.00    | NULL         | 16558       |
| 3      | 130.00    | NULL         | 9093        |
| 3      | 140.00    | NULL         | 5250        |
| 3      | 150.00    | NULL         | 2917        |
| 3      | 160.00    | NULL         | 1676        |
| 3      | 170.00    | NULL         | 1043        |
| 3      | 180.00    | NULL         | 689         |
| 3      | 190.00    | NULL         | 282         |
| 3      | 200.00    | NULL         | 133         |
| 4      | 20.00     | 2991494.783  | 60          |
| 4      | 30.00     | 2355989.903  | 144         |
| 4      | 40.00     | 4199262.765  | 974         |
| 4      | 50.00     | 2877917.184  | 3156        |
| 4      | 60.00     | 3247356.628  | 14959       |
| 4      | 70.00     | 4152905.691  | 30383       |
| 4      | 80.00     | 5111287.320  | 25087       |
| 4      | 90.00     | 8121176.726  | 16241       |
| 4      | 100.00    | NULL         | 13919       |
| 4      | 110.00    | NULL         | 10566       |
| 4      | 120.00    | NULL         | 8588        |
| 4      | 130.00    | NULL         | 7017        |
| 4      | 140.00    | NULL         | 6228        |
| 4      | 150.00    | NULL         | 3815        |
| 4      | 160.00    | NULL         | 2886        |
| 4      | 170.00    | NULL         | 2046        |
| 4      | 180.00    | NULL         | 1393        |
| 4      | 190.00    | NULL         | 853         |
| 4      | 200.00    | NULL         | 275         |
| 5      | 20.00     | 3871396.600  | 60          |
| 5      | 30.00     | 2568850.960  | 124         |
| 5      | 40.00     | 3240429.392  | 130         |
| 5      | 50.00     | 4119057.270  | 141         |
| 5      | 60.00     | 4401022.086  | 209         |
| 5      | 70.00     | 5382112.358  | 204         |
| 5      | 80.00     | 5092394.087  | 939         |
| 5      | 90.00     | 6470751.972  | 1721        |
| 5      | 100.00    | 9780310.320  | 2040        |
| 5      | 110.00    | NULL         | 1693        |
| 5      | 120.00    | NULL         | 1523        |
| 5      | 130.00    | NULL         | 1317        |
| 5      | 140.00    | NULL         | 1317        |
| 5      | 150.00    | NULL         | 1306        |
| 5      | 160.00    | NULL         | 1083        |
| 5      | 170.00    | NULL         | 1025        |
| 5      | 180.00    | NULL         | 951         |
| 5      | 190.00    | NULL         | 804         |
| 5      | 200.00    | NULL         | 323         |
+--------+-----------+--------------+-------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 